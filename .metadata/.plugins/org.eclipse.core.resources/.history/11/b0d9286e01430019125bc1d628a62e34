/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package curlclone;
import java.util.regex.Pattern;

import java.io.IOException;
import java.net.HttpURLConnection;
import java.net.URL;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.BufferedReader;
import java.lang.StringBuilder;

public class App {

    public static void main(String[] args) {
        HTTPRequest h = new HTTPRequest();
        h.run("command");
    }
}

class HTTPRequest{
	public void run(String command) {
		
		String filename = "";
		
		//コマンド処理
		Pattern p = Pattern.compile("[\\s]+");
		String com[] = p.split(command);
		
		String strUrl = "https://www.yahoo.co.jp/";
		
		HttpURLConnection urlConn = null;
		InputStream in = null;
		BufferedReader reader = null;
		
		try {
			//url指定
//			URL url = new URL(com[com.length-1]);
			URL url = new URL("https://www.yahoo.co.jp/");
			
			//コネクション取得
			urlConn = (HttpURLConnection) url.openConnection();

			//初期状態としてGET
			urlConn.setRequestMethod("GET");
			
			//コマンド判定
			for(int i = 0 ; i < com.length -1 ; i ++ ) {
				
				if(com[i].charAt(0) == '-') {
				
					switch(com[i].charAt(1)) {
						case 'o'://ファイル出力を指定
							break;
							
						case 'v'://リクエスト、レスポンスのヘッダ、ボディを表示
							break;
							
						case 'X'://Postの指定
							if(com[i+1].equals("POST")) {
								urlConn.setRequestMethod("POST");
							}
							break;
							
						case 'd'://パラメーター付きポスト
							break;
					}
				}			
			}
			
			//コネクト実行
			urlConn.connect();
			
			int status = urlConn.getResponseCode();
			
			System.out.println("HTTPステータス："+ status);
			
			if(status == HttpURLConnection.HTTP_OK) {
				
				in = urlConn.getInputStream();
				
				InputStreamReader testes = new InputStreamReader(in);
				
				System.out.println(in);
				
				reader = new BufferedReader(new InputStreamReader(in));
				
				StringBuilder output = new StringBuilder();
				String line;
				
				while((line = reader.readLine()) != null) {
//					output.append(line);
					System.out.println(line);
				}
				
				System.out.println(output.toString());
			}
			
		}catch (IOException e) {
			e.printStackTrace();
		}finally {
			try {
				if(reader != null) {
					reader.close();
				}
				if(urlConn != null) {
					urlConn.disconnect();
				}
			}catch (IOException e) {
				e.printStackTrace();
			}
		}
	}
}